String test =
    ">Rosalind_1245GCCTCTCGGCTAATTACATGTTGCTTTAGGACCACGAACGAAGGTCCCCGCCGCCGCAATTTTAATGTAGAGTGAGCTCCTCTGTGCAGTGGATACGGCAAGATCTTTCGAGTAAGTACACGATGTGTCTCCTCCGGTCAGATTCATTCTCTACTCCAACCTCGGTCGGCTCGTTAACACGACTTCAAGATGGGGCGACTGGTCCTTACTACTAGTGTGTCACCATCAGCCGGGCCCATGGACGTTAATAGGAAGGACGTCTTGCGCTAATAATCGAACATGGGGAAGGGCTGGCATCATGAATGCTCAGGCGTGCTACCGCGCCAGTCCGGGAATTCCTCTTCGAACGTTTCTTGAAGTCACGTTCGTTTAAGCTAACACTAATCGCTCTGAACGATCCCAGATCGGCCGACCGTCATCACTGAATTCACATAAAGTGATTTTCACTAATGGCGGTCGGACTGCTCCGCGCCGACCCATGGTTTTTTCCTATAAAGCCCCCTATCAGACGGTCTGTTTAAATTAGCAACTACCCACCGGGAATGCGTGTGAAGGTATGCAATGACCGCAATCTAGATTTATCGTGCCTAAGGTAGGGCCCAGTTTGTAGTAATCCAGTATCTGGGAACCACCATAAGGAATTCCGTATCTATCCAGTATCTTGTCACTCGCACGCTAGTCTTCCAGCTCAGGCATATTAGTAAGTTTTTCTACTTGATAGGGCGCGAACCGGGTTATTGGCTCTACACCGCGCAGAGCAAGGACCTCGTACCTCGTTACAAGCTGAAGTAAATAGCCATAATCCCAGGCGAAGTTAGGTAACTTCCCACGTTGTTTCACTAAAAAAGGACGTCACTCACCATGTTGACGTAGCCTTAACGGGTAGTTTTAG>Rosalind_2110CGTGAACAACGTGGCTTTTTTCGCTTGTACCCTCTGTAGGAAATCGTGGTCCATTGGACCCCCTCGAGTAGGTTTTGAGTGGCAGGACAATCCACAGATGCCCATGCCACGCGCAGTTAGCTATTCCCTTGAGGCGAAACTAGCCCATAGGTGATCTATTCAAAGAGATTAGATCTACACGACGCTCATATCCTATTTCACACCGTGATTACATGTCGCGCTCACGGATCCTCCAGATGACGTGTGTCGGGTTAACATGCTCTCACTATCTTGGGCAGCACCCCTGGACAGAGGAACGGAGTTTTAGCCGTAATTTGCGGCGCCACATCGCAGCAATTGATGCCGTCCCTTTAACCAGAGGATTTATTTCTCTCGAAGGGGCCTGTTTGTGGAGGTGCTACCACGTTCGGGGACGCGGAGTATTTTCAGATGGTTTCAAGGGGGAGCTAAACTACATCACGTCAGATGCGGCTACTTCAGGAGATTCGCAATAGGACAAAGCACTACGCTGGACACATGTTATCTCAATACAATATCACACCGCCCCAAAGGGAATCCAAAAAAGCGGTTAGGTGTTGATTGAAACATAAGCCTGCTAAGCTGCCCGTAGTTTCCTTACCGTGATATAGCTATATGTCGTAGGTACTTGCGTTTACAGTGTATCGACGTTTGGATCCAATGATTGATCGGTGCATTACGGTTAACTGTGATAATACTGCGTTACATTCATGGCGGATCCCACAGAACGTAGACTAAAAAGAATCCGGCGATATTCAGCTCAGGGCGGCCTACAACGCGACCAGGCGTCGAGCGGGAAGAAGCCAGTCGTGACAACAACCGACGTCCCAGGCGGCATAGAGGACTACGGTG>Rosalind_9889TATCCAACTGTTCTTGTCTTGCGACAACCTACCGTCTGCACACATCAACCTAGGAAAGCCCTCGTAACTGTATGCCGGACTAGCCGCAATCTTAACGCGCGGCATCTCCATCAAGCCTGTTTCGTTGGGGACGCATCACCAGTAGCACCATGGGAAAATGTGATCGACACTCTGCAGTGTATGTGCCCATGACCTCCAGCTCAGTTCGGCAATGATTCATCAGGATAATGTGCCCGCGAAATATGTGTTTTCTAAACGGCTGAGCCTGGTGGCAGGCAGGGGGGGCCACTTTATGTCACAAGCGTAGTTTCGAGATCATGCTGAGGGAAGTCGCCCGTCCCGTTAAGACGGACTGCTATAAGTGTATTAGCTCTCCAACTATCTCGTTCACTACTGGCGAAAACCCGTGCAGGACAGGACTTGTATTCGGTAGGCGTTGTCGACAATTTTTTTGTCTAGGTCCCTGTTACACTCAGTATGAACATTTTTCGTACTAATTGTTCTGTGGAAACTAACATGGCATGATTCTAACATCCAGCGAGTCGGTGGGTACGGCTGGCCCTCGAATGCCTTCGTTATCTTTCGCCATCTGTTGGGGTCAGCTACAACCTCCTGGCACGTATTGCATCCGGTTACTTATCACAGCGTATGCAGCGAAACAGTATCTATATTACCGATACGATCTGACTGGCAAACTGTGGCACCAAGGTCTACCGACAGCCCGCTGTGCTACTAGCCTCCGCGGCGCAGGGATTTCTAGATACCAACTAGTAGGCTGGACAAACGTGCCATTAGGCAAGCAGCTGTTGCATATACCATTCTGCCTATGTTTAGGTACTCGCAGGCTGCTTCTAGCGCTCCTCCATTAGTGAGCGGACAACAGTGGGGCATTCTTTC>Rosalind_9161CAGAAGAAATATAGGACACCGCACCGTTTATGCATGGTTTGACTCGGGTGTCAACTTCTCCGCAGCCCTGATAGCTGTGGATCGCGTAGATCTTCGACCGTAGAGACTTTTCAGGAATGGCAGCATGAACACCTCTGGTGCAGCACCTTTTTTCTCAATCCTGATCTAGAGATGCTTACCTACATTATCCGAGGGCGCAACGCCGGGAGCCTACCATCTAAGGCGGACACAACCAAAGTACTCTGGTAAACGAACCTGCCTTCAAGAGCACACCTCGACGGCGCCTCATCTCCCACAACTGTCGGGGTCATCCGAGTGCCTTCCGTTTATGAAAGGTCGGGACTGCTGAAGGCTCCTCGGCTCGTCGACCATTACTTTCGCAACAGACTGCGCTTCATACACATCGTAGAGCACGTGCTTGGGTAGTGCAGACTGCCAATTCTCTAGGCAGATCTAGCTAGGGCCTTTTTTTGCGGCTGTACGCTCTGCTGACACGTTAATCTCCGAGGCCCGATAGCATCATCACCTGAAGATTGGGGCTAAATAGGAACCCTCGTGTTACAACTAGCGCTAGCCTAGCGTCGCGTTCCCATAACCGCGCGGGTGAGGGGGTAGCCTGAATGTAGAACTAATTAGGACAACACACGACAGGGGGGGTTTCAAGCCTTATGGACCATACTCGCGGCCTTACTGTTAGATCCCAGAGGCACCATCTTGTAGGAAGCGAGGCAGAAACGTCACCGCCAATGAAGTGATCATTTCTTTTGGCAGTAATCTTATGGATTCGTTAATATTCGACTTTCGCTGTACAAAACTCCATTCTAGTCAGTTACCGTCCCAAACTAGTCGCCTGTGTTGCTATTTCACACATTAAGCGAATATGCTGATATGTAAGCGTCTGATCAGGGCTACGTTTATAAAAGTGGTGAGGCCCGCACCAGTTTCCACATTGCACTG>Rosalind_7553ATATGCATAACTGTAACCTAGGGTTACAAAGGACACGATGCAGTGCCATCTTACCAGGTGTCTTATCCTTCGCGCAGCTCAATGAGTGTAGGTGTGGGACAAGATGTAGCCTCCCTTGATTAACCCATCTTTAGCTGCCCCAGGGCTTCCGGTGCGTGAAAACCGTCCGACTTTATTGCATTGCAGTCTACGTCCATGTTGCAGACCCAGCTTCCTTTGGATTCGGGTACTATAAGATGAGAGGCCTTTCCAATTACTAAGTATACTGCCCGACTGCGGGAATCTTCACAAGACTGTTCTGTTGGAACACAGCCTATTTACGCTGTGGGGAGTCTCGATTGCCATGGTCAAGTGGATCTGCCTATTACTCACCGGCCGGGCACCCATAGTTTTTCTCACAAACTCAGCTCTGTATATACCCCAAAGAGACTACATCATGACACACCGGCTACGGTCGTAGCTATAATCTCCGTAATTGATACAAAACCAACTCCAAGACTGTCCTGTCACGTCATAGCCGGCTGTTCGAGCAGCGAGCGACAATCCTCCGTGGTACGCCCGCATTCCGGGTATGCGACGAAGCTCAAGCAGTAGAACTTCTTGTTGCCTGCATTTTGCGTATTTGTGGAGGGTAGAAGGACAGTATACCACAATGCTCCTAGGCGCATGACCCTGAAGCAACGTCTACAGTGACAGGTCTCCCGGTGCACTGCTTTGTGGGCGACGAAGAGATCTAGTTCGAGCCTTTATCCAAGAGAGGATCTCTGTTGGCACACGTCATGGACACACTTATTCAGCGACGGACCGTACAAGATACGCAGACGCCCGAGTTCATGGAAGGACTAGGCGCGGTCTACATGCCGCCGACCTCCTGCTCAATTAATTCGTTGTGACCTTTCTTCCTGCGCCAAAACGGCCCCGGCCAAGTCAGCGTCATATACGATAGGAGAGCCCCGAAGATCTCCTGTGTTAACTGTCTAGGATGG>Rosalind_9734CGGGGATAGGAGTAATTGAGTAGTATGACTTTCTTAAAACGTATTGCGATCATTGCTCGGTATTTTCAGCGTAGACCGAATCTTAGTGATCCTAGATCGGTATAACTTTGAGCTTTCTCAGCGCCTGTGATAGTTGAGAATCCTGTCTCACAGCGGGCCGTCGACTGTAGTATAGCAACCTGTCATCGCATTTGCCCTGGTTGCATGCCTCGGCCGTAGTGACACCCGTGCTCATAGGCCAAGGAGAAATTAAAAGCGGTGTTCGCGGCTGTCTAGTAAACCAAGTCAATTAAGATTACCCCGGGCATTCTCTGGACGGAGCAAATACACGTCAATCTACTTTACCGAAGGGTCGCCTTCTGCGGAGTAGGTTTCGTACATTATTCGAAGACCGAAGGACCTAGCGCTCTTGTCGGCCCGCCTCGCTCGCTGCATTGCTCTACTAACTTTGTCACCCTGCACCCTAAATGGCCTATAAACGATAGAACGACAGCACTAAGCGTCGTAAGATCCCTTGTCGCGCTGTGGCTTAAGGAACTGATTTGGCTCTGTTGTACCTGGCCCCAACCGGTTCCGCTTGGGGCTATTTATGGCATGAATCGCACGCAGGGCGGTAGTCGAAACTGCGAATAGTGGGCTCTCCGGGGTAGAGTGGCGCTCCGGTGTAGGGAGGACCCAGCTCGGACTTATTCACGGGTAGCGGCGTGGGCGGGGCGTTTAGTCCGCTACCCCAAAGTACCTTCACAGAGGTGTGTGGGTACAATGAGAGGATACGCTGCTCCAGGTCATTACAATAAGCATAATGAGGGGAGGATGAGATTAATTCACCATGAATAAGGAATTCAAGGGTCACACGACCCACTGTACGAACTCCGATCATT>Rosalind_8389AGCACCGATATAAAGCCATCAGTAAAGGGAGCAGAGCACTTAGTACAATCGCAGCCTCTCAGGTTGCCCAAGGAGTGCAATGGAATCCTTCTTGTTCATGTGCCGGTAACGGAGAAGGTACACTGGATGGGCTTCATGGTACACGTGATTCCGTACTTTTTCTACAATGCGGGACGGGCAATGGATAGAGGGATCCGTCACTCACCAAGTGCACATGCAACTGCGCGTAATTAAAGTCGCGGGATGCTGTCGCTGTAGATATGATGATACCTGTCCGAGTTTGGAGATATCCAATAGCACCCTAGCCTCTGATAAAGTAATCCTATCTCGATTACTCACGCTTCGGGCCATCCACCCCCGCATACTGAGATCATCCTCCGGTCGCTAACACGTCCACTGTCAGAACGTGCGTAGCCGATGTTTCCACCCTGTTAAACACGTGAGTAGGTACAGCTCCTCTTCCAGCTTGCATCATACATTGCACATCGGCTGGGTCGTCAATAAGGCTGAGAAAGGGTGATGCCTTAAGGATCTCCGTATAGGGATCCGCTACGCTTCGTTGCATTTCAAGGAACAATGTACCTCTCAAGGCACGTTACTCAGTGTATATAGGGTTAAGCAATTCAATCGTTACAATACCGCTACAAAGCAACGTGATAGCGATAATCGCAGGTATCGTGTTGCAGGTGAATCCAGAGATATCAAGTCGAAGACCGTGCTGCATATCAAGGTATGCTATTACCCGAAATAATTCACTGGACACCCCCTATTTCTAACCATCGGGGCAAGTATCATTATACGTTGGCCATCTACGGAACGCATTTAGAATCTCACGTACACGCTTAGGAGACTCATTAAGGATTAATCTTTTATAGTCGGATACTCTTCTAGTGTTGGTCCGTTGACCATCTGAAACGGGTGAAGCTGCCACTGCTGTAAGCTTAGTATATGATAGCACTTGGCTGTAG>Rosalind_8518TTGAAAGCGTCATGTAGTTCTTCATGGCACTGATACTCGTAGGAAAAGGGGGATCGATTTGTAGAACGCCCGTCATGGCGCGCCGCTGGGTCGACCCAGGCCGGGGAATGGACCATCATGCGTGACCAAACTATGAGGCAGAAAGCGTCCACTACGCGTAATTAAGATACCCAGGCACTCGCGTCTACATCAAAAGCTAACTCAATTTTCAAGCGTAAAGTGCCCTCAAAATTTTAGGGGCGTACAACGATGACCCCGTACCCTGTTCCCTGGGCCGATAGGGATGGTAATTACATAAGCCGTGTGGATGCAGCTATTTGGGATGTCAGTTGGGAAACGTACATCGCTCCCTTAATAATACGTGCAAGCATTCGACGCACTGGGTCTGCTAACACGCTGCGCTCGGTAAGTCAAGATTGGCGGGGTGAAAATCATCCCAAACAGTCCTACCGATCGTTTAATTCCAGTCGCGAACCTTCGGGACCAACGCTTAACACGCTTGAACCTGATGCTCGTCGATACGATCATGCCATCACGTGTCACCGGACTCCTAATCATTGATTGGTTTCACATTTCACCCTAACGGCGATGCACTGTGGTATAGTGCTCGTTTAAAAGGCGACCTAATAGCGAAGCTCTCTGAGGCACATGTGGTCCGGTTCGACAGAACGGCTTAGTTCTTGTCAGCGGGAGGTACCGCTGCTCGAATCCACGACCTATCTATCTCTATATTCGCGGGCAGTTTTTGGGAGGTGGACCCCGGATTTGGGTTACGGAAAGCGGTTGTGCCGAATGGCAAAACCTCTACGCCTAGGTGCGCGGGGTCGGAGCTGGAAGATCCCGGGCAGACAACAAGGCCGATAATCACACCCGATCCTGACTAGCATTTCGTCAGCTGAAGGATTCTTAACTGGGGAAATTTGGTTGCGACTTCCTTCGAATAGCTGGAGGCCTTAAGTAAGGCCGACTTTCTG";

void main() {
  RegExp exp = RegExp(r'(Rosalind_\d+)(\w+)');
  Iterable<Match> matches = exp.allMatches(test);
  var stored = [
    for (var data in matches) [data.group(1), data.group(2)]
  ];
  print(stored);
  
  List<Fasta> mapped = stored
      .map(
        (e) => Fasta(header: e[0]!, sequence: e[1]!),
      )
      .toList();

  for (Fasta fasta in mapped) {
    print(fasta.countGcContent());
  }
  
  var highest = mapped.fold([], (sorted, fasta) {
    if (sorted.isEmpty) {
      return [fasta.header, fasta.countGcContent()];
    } else if (fasta.countGcContent() > sorted[1]) {
      return [fasta.header, fasta.countGcContent()];
    } else {
      return sorted;
    }
  });
  
  print("${highest[0]}\n${highest[1].toStringAsFixed(6)}");
}

class Fasta {
  final String header;
  final String sequence;
  Fasta({required this.header, required this.sequence});

  double countGcContent() {
    int countGc = sequence.split("").fold(
          0,
          (previousValue, element) => element == "C" || element == "G"
              ? previousValue+1
              : previousValue,
        );
    double result = countGc/sequence.length*100;
    return result;
  }
}
